<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rossmo's Formula</title>
    <link rel="stylesheet" href="./style/style.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Signika+Negative:wght@300&display=swap" rel="stylesheet">
</head>
<body>
    <h1 class="title">Rossmo's Formula Simulator</h1>
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d11961.770990347415!2d-8.29790585!3d41.451311649999994!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0xd24f00207643a85%3A0x7ec41765782ba2d1!2sTrigueirinha!5e0!3m2!1spt-PT!2spt!4v1623419353389!5m2!1spt-PT!2spt" width="500" height="500" id="map" allowfullscreen="" loading="lazy"></iframe>
    <canvas height="43" width="43" class="canvas"></canvas>
    <div class="control">
        <form>
            <div class="labels">Show:</div>
            <input type="checkbox" name="map" id="probability-map">
            <label for="probability-map">Probability map</label><br>
            <input type="checkbox" name="map" id="crimes-residence-map">
            <label for="crimes-residence-map">Crimes and residence</label>
            <div class="labels">Add or remove:</div>
            <input type="radio" name="location" class="inputs" id="crime" value="crime">
            <label for="crime">Crime</label><br>
            <input type="radio" name="location" class="inputs" id="residence" value="residence">
            <label for="residence">Real residence</label><br>
            <div class="labels">The size of the <strong>buffer zone</strong>, B.</div>
            <input type="range" min="0" max="10" class="inputs" id="B-range"><output id="B-output">0.00</output>
            <div class="labels">
                The value f says how fast the 
                <br>probability decays <strong>beyond</strong> the buffer zone.
            </div>
            <input type="range" min="0" max="2" step="0.01" class="inputs" id="f-range"><output id="f-output">0.00</output>
            <div class="labels">
                The value g says how fast the 
                <br>probability decays <strong>inside</strong> the buffer zone.
            </div>
            <input type="range" min="0" max="5" step="0.01" class="inputs" id="g-range"><output id='g-output'>0.00</output>
            <div id="lables">
                Opacity of probability map.
            </div>
            <input type="range" min="0" max="1" step="0.01" class="inputs" id="opacity-range"><output id='opacity-output'>0.00</output>
        </form>
    </div>
    <div class="content">
        Rossmo's formula is used to predict where a serial criminal <br>
        lives based on the location of the crimes.
        <br>
        The green cells indicate body drop sites. Using Rossmo's formula, the <br> 
        probability \(P_{ij}\) for a given cell at row \(i\) and column \(j\) to be the killers residence is given by
        \[P_{ij}=k\sum_{n=0}^{c}\left[ \frac{\phi_{ij}}{\left( \left| X_{i}-x_{n}\right|+\left| Y_{j} - y_{n} \right|\right)^{f}} + 
        \frac{\left(1 - \phi_{ij} \right)\left( B^{g-f} \right)}{\left(2B-\left
        | X_{i}-x_{n}\right|+\left| Y_{j} - y_{n} \right|\right)^{g}}\right]\]
        where \[\phi_{ij}=\begin{cases} 1, & \mbox{if } \left| X_{i}-x_{n}\right|+\left| Y_{j} - y_{n} \right| > B\\ 0, & \mbox{otherwise} \end{cases}\]
        and is indicated by the color of each cell. The brighter the color <br>
        the higher the probability.
    </div>
    <footer>
Rossmo's Formula
Copyright &copy;2021 Andr√© Pinheiro
Read the licence for more informations.
</footer>
    <script >
    MathJax = {
      jax: ["input/TeX", "output/HTML-CSS"],
      extensions: ["tex2jax.js"],
      "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic: false }  },
      tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], 
      displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], 
      processEscapes: true, 
      ignoreClass: "tex2jax_ignore|dno" },
      TeX: { noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } } },
      messageStyle: "none"
    };
    </script>  
    <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
    <script type="module" src="./src/main.js"></script>
    <script type="module" src="./src/events.js"></script>
</body>
</html>
